<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Capitais do Mundo</title>
    <link rel="stylesheet" href="style.css">
</head>

<!--
AINDA PRECISO FAZER ALTERAÇÕES!
-->

<body>
    <main>
        <h1>Digite o nome de um país</h1>
        <form id="formulario">
            <label for="pais">Digite o país: </label>
            <input type="text" id="pais" required />
            <br />
            <button type="submit">Descobrir Capital</button>
        </form>
        <h2>Resultado:</h2>
        <p id="resultado"></p>

        <script>
            let listaPaises = [];

            async function carregarPaises() {
                try {
                    const resposta = await fetch('http://localhost:3000/buscaPais');
                    listaPaises = await resposta.json();
                } catch (erro) {
                    console.error('Erro ao carregar os países:', erro);
                }
            }

            carregarPaises();

            const form = document.getElementById('formulario');
            const resultado = document.getElementById('resultado');

            form.addEventListener('submit', (event) => {
                event.preventDefault();

                let paisInput = document.getElementById('pais').value.trim().toLowerCase();

                paisInput = paisInput.normalize("NFD").replace(/[\u0300-\u036f]/g, "");

                const encontrado = listaPaises.find(p => 
                    p.pais.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "") === paisInput
                );

                if (encontrado) {
                    resultado.textContent = `A capital do ${encontrado.pais} é ${encontrado.capital}.`;
                } else {
                    resultado.textContent = "Não foi possível encontrar esse país. Tente novamente!";
                }
            });
        </script>
    </main>
</body>
</html>
