<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Previsão do Clima - Santa Catarina</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main>
    <h1>Santa Catarina, SC</h1>
    <h2 id="dataDia"></h2>
    <img id="icone" src="" alt="Ícone de clima">
    <div id="temperatura"></div>
    <div style="font-family: Arial, Helvetica, sans-serif;" id="clima"></div>
  </main>

  <script>
    const latitude = -27.5954;
    const longitude = -48.5480;
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&hourly=temperature_2m,apparent_temperature,precipitation_probability&timezone=America/Sao_Paulo`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        const temperatures = data.hourly.temperature_2m;
        const apparentTemps = data.hourly.apparent_temperature;
        const rainProb = data.hourly.precipitation_probability;
        const times = data.hourly.time;

        const agora = new Date();
        const ano = agora.getFullYear();
        const mes = String(agora.getMonth() + 1).padStart(2, '0');
        const dia = String(agora.getDate()).padStart(2, '0');
        const hora = String(agora.getHours()).padStart(2, '0');

        const horaAtual = `${ano}-${mes}-${dia}T${hora}:00`;

        const index = times.indexOf(horaAtual);

        const dataDiaDiv = document.getElementById('dataDia');
        const iconeImg = document.getElementById('icone');
        const temperaturaDiv = document.getElementById('temperatura');
        const climaDiv = document.getElementById('clima');

        if (index !== -1) {
          const temp = temperatures[index];
          const aparente = apparentTemps[index];
          const chuva = rainProb[index];

          dataDiaDiv.innerHTML = `Tempo agora - ${dia}/${mes}/${ano} - ${hora}:00h`;

          if (chuva > 80) {
            iconeImg.src = "imgs/trovoada.png";
          } else if (chuva > 60) {
            iconeImg.src = "imgs/chuva.png";
          } else if (chuva > 40) {
            iconeImg.src = "imgs/nublado.png";
          } else {
            if (temp < 10) {
              iconeImg.src = "imgs/frio.png";
            } else {
              iconeImg.src = "imgs/sol.png";
            }
          }

          temperaturaDiv.innerHTML = `${temp}°C`;

          climaDiv.innerHTML = `
            Sensação térmica:<strong>${aparente}°C</strong><br>
            Chance de chuva:<strong>${chuva}%</strong>`;
        } else {
          climaDiv.innerText = 'Não foi possível encontrar a previsão para a hora atual.';
        }
      })
      .catch(err => {
        console.error("Erro:", err);
        document.getElementById('clima').innerText = 'Erro ao carregar dados.';
      });
  </script>
</body>
</html>
